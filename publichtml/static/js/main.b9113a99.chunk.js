(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{23:function(e,t,a){e.exports=a(50)},29:function(e,t,a){},31:function(e,t,a){},50:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(21),i=a.n(r),o=(a(29),a(9)),l=a.n(o),c=a(11),u=a(10),m=a(1),p=a(2),d=a(5),h=a(3),g=a(7),f=a(4);a(31);function v(e){window.localStorage.setItem("calorieJwt",e)}var E=function(e){function t(){return Object(m.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"loader"})}}]),t}(n.Component),b=a(6),y=a.n(b),D=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).login=a.login.bind(Object(g.a)(a)),a.adminManagerEntry=Boolean(a.props.roleOptions),a.state={email:a.props.email||"",password:"",error:"",name:a.props.name||"",confirmPassword:"",newUser:a.adminManagerEntry,role:a.props.role||"",deleting:!1,loading:!1},a}return Object(f.a)(t,e),Object(p.a)(t,[{key:"register",value:function(){var e=this;if(this.setState({loading:!0}),this.props.updating)return this.props.updateUser({name:this.state.name,email:this.state.email,role:this.state.role},this.props.closeModal());y()({url:"auth/register",method:"POST",data:{name:this.state.name,email:this.state.email,password:this.state.password,role:this.state.role}}).then(function(){var t=Object(u.a)(l.a.mark(function t(a){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:"success!"===a.data&&(e.adminManagerEntry?(e.props.getUserData(),e.props.closeModal()):e.login());case 2:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}()).catch(function(t){e.setState({error:t.response?t.response.data:t.message})}).finally(function(){e.setState({loading:!1})})}},{key:"login",value:function(){var e=this;this.setState({loading:!0}),y()({url:"auth/login",method:"GET",params:{email:this.state.email,password:this.state.password}}).then(function(t){"Login was successful!"===t.data.message&&(y.a.defaults.headers.common.Authorization=t.data.jwt,v(t.data.jwt),e.props.getUserData(!1,!0))}).catch(function(t){e.setState({error:t.response?t.response.data:t.message})}).finally(function(){e.setState({loading:!1})})}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{id:"loginDiv"},s.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.state.newUser?e.register():e.login()}},this.state.newUser?s.a.createElement("div",null,this.props.updating?"Update User:":"Creating new account!"):null,s.a.createElement("div",null,"admin"===this.props.myRole?this.props.displayed?s.a.createElement("div",null,"Meals data is already loaded."):s.a.createElement("input",{className:"unselectedUserButton",type:"button",value:"Edit".concat(this.props.me?" Your":""," Meals Data"),onClick:function(){e.props.getUserData(),e.props.closeModal()}}):null),this.state.newUser?s.a.createElement("input",{placeholder:this.adminManagerEntry?"User's Name":"Your Name",id:"userName",type:"text",onChange:function(t){e.setState({name:t.target.value})},value:this.state.name}):null,s.a.createElement("input",{type:"email",id:"email",placeholder:"email",value:this.state.email,onChange:function(t){return e.setState({email:t.target.value})}}),this.adminManagerEntry?s.a.createElement("select",{id:"newUserRole",onChange:function(t){e.setState({role:t.target.value})},value:this.state.role},s.a.createElement("option",{disabled:!0,value:""},"Select Role"),this.props.roleOptions):null,this.props.updating?null:s.a.createElement("input",{type:"password",id:"password",placeholder:"password",value:this.state.password,onChange:function(t){return e.setState({password:t.target.value})}}),this.state.newUser&&!this.props.updating?s.a.createElement("input",{type:"password",id:"confirmPassword",placeholder:"confirm password",value:this.state.confirmassword,onChange:function(t){return e.setState({confirmPassword:t.target.value})}}):null,this.state.newUser&&!this.props.updating&&this.state.confirmPassword&&this.state.confirmPassword!==this.state.password?s.a.createElement("div",{className:"errorMessage"},"Passwords do not match!"):null,s.a.createElement("div",null,s.a.createElement("input",{type:"submit",id:"login",value:this.state.newUser?this.props.updating?"Update Account":"Create Account":"Login",disabled:this.loginDisabled}),this.props.loading||this.state.loading?s.a.createElement(E,null):null),s.a.createElement("div",null,this.state.deleting?s.a.createElement(s.a.Fragment,null,s.a.createElement("div",null,"Please confirm"),s.a.createElement("input",{type:"button",value:"Cancel",onClick:function(){return e.setState({deleting:!1})}})):null,this.props.updating?s.a.createElement("input",{className:"deleteUser",value:"".concat(this.state.deleting?"Yes, ":"","Delete"),type:"button",onClick:function(){e.state.deleting?e.props.deleteUser(e.props.closeModal):e.setState({deleting:!0})}}):null,s.a.createElement("input",{type:"button",id:"loginToggle",value:this.state.newUser?this.adminManagerEntry?"Cancel":"Back to login":"Create New User",onClick:function(){e.adminManagerEntry?e.props.closeModal():e.setState({newUser:!e.state.newUser})}})),s.a.createElement("div",{className:"errorMessage"},this.state.error)))}},{key:"loginDisabled",get:function(){return this.state.newUser?this.state.password!==this.state.confirmPassword||!this.state.name.trim():!this.state.email.trim()||!this.state.password.trim()}}]),t}(n.Component),S=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={search:"",max:a.props.max},a}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"search-container"},s.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.props.setSearch&&e.props.setSearch(e.state.search),e.props.setMax(e.state.max||10)}},this.props.setSearch?s.a.createElement("input",{className:"searchInput",onChange:function(t){return e.setState({search:t.target.value})},type:"text",value:this.state.search,placeholder:"Search...",id:"nameSearch"}):null,s.a.createElement("button",{type:"submit",className:"fa fa-search"}),s.a.createElement("input",{className:"maxDisplayInput",type:"number",min:1,max:100,value:this.state.max,onChange:function(t){e.setState({max:t.target.value})}}),s.a.createElement("button",{className:"fa fa-arrow-left backward",onClick:function(){return e.props.setSkip(Number(e.props.skip)-Number(e.props.max))},disabled:0===this.props.skip}),s.a.createElement("button",{className:"fa fa-arrow-right forward",onClick:function(){return e.props.setSkip(Number(e.props.skip)+Number(e.props.max))},disabled:this.props.skip+this.props.max>=this.props.count}),this.props.loading?s.a.createElement(E,null):null))}}]),t}(n.Component),C=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).getUserList=a.getUserList.bind(Object(g.a)(a)),a.state={error:"",data:[],count:0,skip:0,search:"",max:10,success:"",loading:!1},a}return Object(f.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.getUserList()}},{key:"componentDidUpdate",value:function(e,t){t.skip===this.state.skip&&t.max===this.state.max&&t.search===this.state.search||this.getUserList()}},{key:"getUserList",value:function(){var e=this;this.setState({loading:!0}),y()({url:"users/getUserList",method:"GET",params:{search:this.state.search,skip:this.state.skip,max:this.state.max}}).then(function(t){var a=t.data;e.setState({error:"",success:"",data:a.users,count:a.count})}).catch(function(t){e.setState({error:t.response?t.response.data:t.message})}).finally(function(){return e.setState({loading:!1})})}},{key:"deleteUser",value:function(e,t){var a=this;this.setState({loading:!0}),y()({url:"users",method:"DELETE",data:{_id:e}}).then(function(e){a.setState({error:"",success:"Deleted ".concat(e.data.name,", ").concat(e.data.email,".")}),a.getUserList()}).catch(function(e){a.setState({error:e.response?e.response.data:e.message})}).finally(function(){a.setState({loading:!1}),t&&t()})}},{key:"render",value:function(){return"regular"===this.props.myRole?null:s.a.createElement("div",{className:"userList"},s.a.createElement("h2",null,"Calorie Tracker Users"),this.users,this.state.error?s.a.createElement("div",{className:"errorMessage"},this.state.error):null)}},{key:"roleOptions",get:function(){var e=[s.a.createElement("option",{key:"regular",id:"newRegularSelect",value:"regular"},"regular")];return/^manager|admin$/.test(this.props.myRole)&&e.push(s.a.createElement("option",{key:"manager",id:"newManagerSelect",value:"manager"},"manager")),"admin"===this.props.myRole&&e.push(s.a.createElement("option",{key:"admin",id:"newAdminSelect",value:"admin"},"admin")),e}},{key:"users",get:function(){var e=this,t=[];return this.state.data.forEach(function(a,n){var r=a._id===e.props.myId;t.push(s.a.createElement(O,Object.assign({deleteUser:function(t){return e.deleteUser(a._id,t)},setModalContents:e.props.setModalContents,roleOptions:e.roleOptions,getUserData:function(){e.props.getUserData(a._id)},getUserList:e.getUserList,key:a._id,thisIsMe:r,displayed:a._id===e.props.selectedId,myRole:e.props.myRole,updateData:function(t){var s=e.state.data;s[n]=t,e.setState({data:s}),a._id===e.props.selectedId&&e.props.getUserData(e.props.selectedId)}},a)))}),s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"userListHeader"},s.a.createElement(k,{loading:this.state.loading,setModalContents:this.props.setModalContents,getUserList:this.getUserList,myId:this.props.myId,roleOptions:this.roleOptions}),s.a.createElement(S,{loading:this.state.loading,skip:this.state.skip,count:this.state.count,max:this.state.max,setSkip:function(t){e.setState({skip:t||0})},setMax:function(t){t=Number(t),e.setState({skip:Math.floor(Number(e.state.skip)/t)*t,max:Number(t)})},setSearch:function(t){return e.setState({search:t})}})),s.a.createElement("div",{className:"userListTable"},s.a.createElement("table",null,s.a.createElement("tbody",null,this.state.success?s.a.createElement("tr",null,s.a.createElement("td",{colSpan:"3"},s.a.createElement("div",{className:"successMessage"},this.state.success))):null,t))))}}]),t}(n.Component),k=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={active:!1},a}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement(s.a.Fragment,null,s.a.createElement("input",{type:"button",id:"createNewUser",value:"Create New User",onClick:function(){e.props.setModalContents(s.a.createElement(D,{loading:e.props.loading,getUserData:e.props.getUserList,roleOptions:e.props.roleOptions,closeModal:function(){return e.props.setModalContents(null)}}))}}))}}]),t}(n.Component),O=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).updateUser=a.updateUser.bind(Object(g.a)(a)),a.state={error:"",deleting:!1,loading:!1},a}return Object(f.a)(t,e),Object(p.a)(t,[{key:"updateUser",value:function(e,t){var a=this;this.setState({loading:!0}),y()({url:"users",method:"PATCH",data:Object(c.a)({_id:this.props._id},e)}).then(function(e){a.props.updateData(e.data),a.setState({error:""})}).catch(function(e){a.setState({error:e.response?e.response.data:e.message})}).finally(function(e){t&&t(),a.setState({loading:!1})})}},{key:"render",value:function(){var e=this,t=this.props.thisIsMe;return s.a.createElement(s.a.Fragment,null,s.a.createElement("tr",{className:"".concat(this.props.displayed?"currentUserEntry ":"","userEntry"),onClick:function(){"admin"!==e.props.myRole&&"admin"===e.props.role?e.setState({error:"You may not edit admins."}):e.props.setModalContents(s.a.createElement(D,{me:t,myRole:e.props.myRole,updateUser:e.updateUser,updating:!0,adminManagerEntry:!0,deleteUser:e.props.deleteUser,roleOptions:e.props.roleOptions,getUserData:e.props.getUserData,displayed:e.props.displayed,closeModal:function(){return e.props.setModalContents(null)},name:e.props.name,email:e.props.email,role:e.props.role,loading:e.state.loading}))}},s.a.createElement("td",{className:"userName"},"".concat(this.props.name).concat(t?" (You)":"")),s.a.createElement("td",{id:this.props.email},this.props.email),s.a.createElement("td",{className:"newUserRole"},this.props.role)),this.state.error?s.a.createElement("tr",null,s.a.createElement("td",{colSpan:"3"},s.a.createElement("div",{className:"errorMessage"},this.state.error))):null)}}]),t}(n.Component),w=a(22),M=a.n(w),j=function(e){function t(){return Object(m.a)(this,t),Object(d.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"modalbackground"},s.a.createElement("div",{className:"modalBody"},s.a.createElement(M.a,null,this.props.children)))}}]),t}(n.Component),N=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={editing:!1,pendingParCalories:a.props.parCalories,error:"",loading:!1},a.changePar=a.changePar.bind(Object(g.a)(a)),a}return Object(f.a)(t,e),Object(p.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.parCalories!==e.parCalories&&this.setState({pendingParCalories:this.props.parCalories})}},{key:"changePar",value:function(){var e=this;this.setState({loading:!0}),y()({url:"users",method:"PATCH",data:{parCalories:this.state.pendingParCalories,_id:this.props.selectedId}}).then(function(t){var a=t.data;e.props.setPar(a.parCalories),e.setState({editing:!1,error:"",pendingParCalories:a.parCalories})}).catch(function(t){e.setState({error:t.response?t.response.data:t.message})}).finally(function(){return e.setState({loading:!1})})}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{id:"parChanger",onClick:function(){return e.setState({editing:!0})},onBlur:function(){e.out=setTimeout(function(){return e.setState({editing:!1,error:""})},500)}},s.a.createElement("div",{className:"label"},"Daily Calorie Limit:"),this.state.editing?s.a.createElement(s.a.Fragment,null,s.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.changePar()}},s.a.createElement("div",null,s.a.createElement("input",{id:"parChangerInput",type:"number",value:this.state.pendingParCalories,autoFocus:!0,className:"input",onChange:function(t){return e.setState({pendingParCalories:t.target.value})},onFocus:function(t){t.target.select(),clearTimeout(e.out)}})),s.a.createElement("div",null,Number(this.state.pendingParCalories)!==Number(this.props.parCalories)?s.a.createElement("input",{type:"submit",onFocus:function(){clearTimeout(e.out)},id:"parChangerConfirm",value:this.state.pendingParCalories<this.props.parCalories?"Submit to eating less":"Confirm to eat more"}):null,this.state.loading?s.a.createElement(E,null):null))):s.a.createElement("div",{id:"parChangerDisplay",className:"value"},this.props.parCalories),2e3!==this.props.parCalories||this.state.editing?null:s.a.createElement("div",{className:"label"},"Click to edit"),this.state.error?s.a.createElement("div",{className:"errorMessage"},this.state.error):null)}}]),t}(n.Component),T=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={pendingValue:a.props.value,editing:!1},a}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"entryCell".concat(this.props.className?" ".concat(this.props.className):""),id:this.props.id,onBlur:function(t){e.out=setTimeout(function(){return e.setState({editing:!1})},500)}},this.state.editing?s.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.props.submit(e.state.pendingValue),e.setState({editing:!1})}},this.editableInput,s.a.createElement("div",null,s.a.createElement("input",{className:"editableInputSubmit",type:"submit",value:"Submit",disabled:this.state.pendingValue===this.props.value,onFocus:function(){return clearTimeout(e.out)}}),s.a.createElement("input",{type:"button",value:"Cancel",onClick:function(){return e.setState({editing:!1})}}))):s.a.createElement("div",{onClick:function(){return e.setState({editing:!0})}},this.props.value))}},{key:"editableInput",get:function(){var e=this;return s.a.createElement("input",{className:"editableInput",maxLength:this.props.maxLength,autoComplete:"off",value:this.state.pendingValue,onChange:function(t){e.setState({pendingValue:t.target.value})},autoFocus:!0,onFocus:function(t){t.target.select(),clearTimeout(e.out)},size:this.props.maxLength,type:this.props.type||"text",max:this.props.max,min:this.props.min})}}]),t}(n.Component),U=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).state=a.defaultState,a.saveMeal=a.saveMeal.bind(Object(g.a)(a)),a}return Object(f.a)(t,e),Object(p.a)(t,[{key:"componentDidUpdate",value:function(){var e=this.enteredDate<new Date(this.props.fromDate)||this.enteredDate>new Date(this.props.toDate);!this.state.dateRangeWarning&&e?this.setState({dateRangeWarning:!0}):this.state.dateRangeWarning&&!e&&this.setState({dateRangeWarning:!1})}},{key:"saveMeal",value:function(){var e=this;if(this.state.dateRangeWarning&&!this.state.dateRangeWarningNoted)return this.setState({dateRangeWarningNoted:!0,error:"You are setting your meal outside the visible date range. Submit again to confirm."});this.setState({loading:!0}),y()({url:"meals",method:this.props.editing?"PATCH":"POST",data:{description:this.state.description,calories:this.state.calories,date:this.enteredDate,time:60*Number(this.state.hours)+Number(this.state.minutes),userId:this.props.selectedId,_id:this.props._id}}).then(function(t){var a=t.data,n=e.defaultState;n.success='Added "'.concat(a.description,'" to your meals!'),e.setState(n),e.props.editing?e.props.closeModal():e.setState({loading:!1}),e.props.updateMealsList()}).catch(function(t){e.setState({error:t.response?t.response.data:t.message,loading:!1})})}},{key:"render",value:function(){var e=this,t=this.props.editing,a={onFocus:function(e){return e.target.select()},type:"number"};return s.a.createElement("div",{className:"mealsEntry"},s.a.createElement("h2",null,"".concat(this.props.editing?"Change This":"Add a"," Meal")),s.a.createElement("form",{onSubmit:function(t){t.preventDefault(),e.saveMeal()}},s.a.createElement("input",{placeholder:"Description",type:"text",id:"enterDescription".concat(t?"Edit":""),value:this.state.description,onChange:function(t){return e.setState({description:t.target.value})}}),s.a.createElement("input",{placeholder:"Number of Calories",type:"number",id:"enterCalories".concat(t?"Edit":""),value:this.state.calories,onChange:function(t){return e.setState({calories:t.target.value})}}),s.a.createElement("div",null,s.a.createElement("label",{htmlFor:"enterMonth"},"Date"),s.a.createElement("input",Object.assign({},a,{min:"1",max:"12",id:"enterMonth".concat(t?"Edit":""),value:this.state.month,onChange:function(t){return e.setState({month:t.target.value})}})),s.a.createElement("input",Object.assign({},a,{min:"1",max:"31",id:"enterDate".concat(t?"Edit":""),value:this.state.date,onChange:function(t){return e.setState({date:t.target.value})}})),s.a.createElement("input",Object.assign({},a,{min:"1900",max:"9999",id:"enterYear".concat(t?"Edit":""),value:this.state.year,onChange:function(t){return e.setState({year:t.target.value})}}))),s.a.createElement("div",null,s.a.createElement("label",{htmlFor:"enterTime"},"Time"),s.a.createElement("input",Object.assign({},a,{min:"0",max:"23",id:"enterTime".concat(t?"Edit":""),value:this.state.hours,onChange:function(t){return e.setState({hours:t.target.value})}})),s.a.createElement("input",Object.assign({},a,{min:"1",max:"60",id:"enterMinutes".concat(t?"Edit":""),value:this.state.minutes,onChange:function(t){return e.setState({minutes:t.target.value})}}))),this.state.error?s.a.createElement("div",{className:"errorMessage"},this.state.error):null,this.state.success?s.a.createElement("div",{className:"successMessage"},this.state.success):null,s.a.createElement("input",{id:"confirmConsumption".concat(t?"Edit":""),type:"submit",value:"Confirm Consumption"}),this.state.loading||this.props.loading?s.a.createElement(E,null):null),this.props.editing?s.a.createElement(s.a.Fragment,null,s.a.createElement("input",{type:"button",value:"Cancel",onClick:function(){return e.props.closeModal()}}),this.state.deleting?s.a.createElement(s.a.Fragment,null,s.a.createElement("div",null,"Please confirm"),s.a.createElement("input",{type:"button",value:"Cancel",onClick:function(){return e.setState({deleting:!1})}})):null,s.a.createElement("input",{className:"deleteMealButton",value:"".concat(this.state.deleting?"Yes, ":"","Delete"),type:"button",onClick:function(){e.state.deleting?(e.props.deleteEntry(),e.props.closeModal()):e.setState({deleting:!0})}})):null)}},{key:"defaultState",get:function(){var e=new Date;return{description:this.props.description||"",calories:this.props.calories||"",month:this.props.month||e.getMonth()+1,date:this.props.date||e.getDate(),year:this.props.year||e.getFullYear(),hours:this.props.hours||e.getHours(),minutes:this.props.minutes||e.getMinutes(),error:"",success:"",dateRangeWarning:!1,dateRangeWarningNoted:!1,loading:!1}}},{key:"enteredDate",get:function(){return new Date("".concat(this.state.month,"/").concat(this.state.date,"/").concat(this.state.year))}}]),t}(n.Component),L=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={sortedBy:"",data:[],fromDate:new Date(new Date((new Date).setHours(0,0,0,0)).setDate(-7)),toDate:new Date((new Date).setHours(0,0,0,0)),fromTime:0,toTime:1439,error:"",max:20,skip:0,count:0},a.calsPerDay={},a.updateList=a.updateList.bind(Object(g.a)(a)),a}return Object(f.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.updateList()}},{key:"componentDidUpdate",value:function(e,t){e.update===this.props.update&&e.selectedId===this.props.selectedId||this.updateList()}},{key:"updateList",value:function(){var e=this;this.setState({loading:!0}),y()({url:"meals",method:"GET",params:{fromDate:this.state.fromDate,toDate:this.state.toDate,userId:this.props.selectedId}}).then(function(t){var a=t.data;e.calsPerDay={};for(var n=0;n<a.length;n++)e.calsPerDay[a[n].date]?e.calsPerDay[a[n].date]+=a[n].calories:e.calsPerDay[a[n].date]=a[n].calories;var s=a.length>=999?"Your date Filter is too broad.":"";e.setState({data:a,error:s,count:a.length})}).catch(function(t){e.setState({error:t.response?t.response.data:t.message})}).finally(function(){e.setState({loading:!1})})}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"mealsList"},s.a.createElement("h2",{className:"header"},"Meals List"),s.a.createElement(x,{setFromDate:function(t){e.setState({fromDate:t},e.updateList)},fromDate:this.state.fromDate,setToDate:function(t){e.setState({toDate:t},e.updateList)},toDate:this.state.toDate,setFromTime:function(t){e.setState({fromTime:t})},fromTime:this.state.fromTime,setToTime:function(t){e.setState({toTime:t})},toTime:this.state.toTime,updateList:this.updateList}),this.state.error?s.a.createElement("div",{className:"errorMessage"},this.state.error):null,this.entryRows.length?s.a.createElement("div",{className:"mealsTable"},s.a.createElement("div",{className:"userListHeader"},s.a.createElement(S,{loading:this.state.loading,skip:this.state.skip,count:this.state.count,max:this.state.max,setSkip:function(t){e.setState({skip:t||0})},setMax:function(t){t=Number(t),e.setState({skip:Math.floor(Number(e.state.skip)/t)*t,max:Number(t)})}})),s.a.createElement("table",null,s.a.createElement("thead",null,s.a.createElement("tr",null,s.a.createElement("th",null,"Description"),s.a.createElement("th",null,"Calories"),s.a.createElement("th",null,"Date"),s.a.createElement("th",null,"Time"))),s.a.createElement("tbody",null,this.entryRows))):s.a.createElement("div",{id:"noMealsMessage"},"There are no meals in this date range."))}},{key:"entryRows",get:function(){for(var e=this,t=[],a=this.state.skip;a<this.state.skip+this.state.max&&a<this.state.count;a++){var n=this.state.data[a];n.time>=this.state.fromTime&&n.time<=this.state.toTime&&t.push(s.a.createElement(I,{setLoading:function(t){return e.setState({loading:t})},setModalContents:this.props.setModalContents,selectedId:this.props.selectedId,updateList:this.updateList,over:this.calsPerDay[n.date]>this.props.parCalories,key:"".concat(n._id).concat(n.description).concat(n.calories).concat(n.date).concat(n.time),data:n,_id:n._id,fromDate:this.state.fromDate,toDate:this.state.toDate}))}return t}}]),t}(n.Component),x=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={error:""},a.newDate=a.newDate.bind(Object(g.a)(a)),a}return Object(f.a)(t,e),Object(p.a)(t,[{key:"newDate",value:function(e,t){var a,n=this,s=function(){return n.setState({error:"Invalid Date"}),t};try{return"Invalid Date"===(a=new Date(e)).toString()?(n.setState({error:"Invalid Date"}),t):(this.setState({error:""}),a)}catch(s){return console.log(s.message),s()}}},{key:"newTime",value:function(e,t,a){var n,s=this,r=function(){return s.setState({error:"Invalid Time"}),a};try{return(n=60*Number(e)+Number(t))<0||n>1439?(s.setState({error:"Invalid Time"}),a):(this.setState({error:""}),n)}catch(r){return console.log(r.message),r()}}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"filters"},s.a.createElement("span",{className:"smallLabel"},"Filter by Date"),s.a.createElement("table",null,s.a.createElement("tbody",null,s.a.createElement("tr",null,s.a.createElement("td",null,"From"),s.a.createElement("td",null,s.a.createElement(T,{min:"1",max:"12",type:"number",submit:function(t){e.props.setFromDate(e.newDate("".concat(t,"/").concat(e.fromDate,"/").concat(e.fromYear),e.props.fromDate))},maxLength:2,value:this.fromMonth})),s.a.createElement("td",null,"/"),s.a.createElement("td",null,s.a.createElement(T,{min:"1",max:"31",type:"number",submit:function(t){e.props.setFromDate(e.newDate("".concat(e.fromMonth,"/").concat(t,"/").concat(e.fromYear),e.props.fromDate))},maxLength:2,value:this.fromDate})),s.a.createElement("td",null,"/"),s.a.createElement("td",null,s.a.createElement(T,{min:"1900",max:"9999",type:"number",submit:function(t){e.props.setFromDate(e.newDate("".concat(e.fromMonth,"/").concat(e.fromDate,"/").concat(t),e.props.fromDate))},maxLength:4,value:this.fromYear,className:"fromYear"})),s.a.createElement("td",{className:"space"}),s.a.createElement("td",null,s.a.createElement(T,{min:"0",max:"23",type:"number",submit:function(t){e.props.setFromTime(e.newTime(t,e.fromMinutes,e.props.fromTime))},maxLength:2,value:this.fromHours<10?"0".concat(this.fromHours):this.fromHours})),s.a.createElement("td",null,":"),s.a.createElement("td",null,s.a.createElement(T,{min:"1",max:"60",type:"number",submit:function(t){e.props.setFromTime(e.newTime(e.fromHours,t,e.props.fromTime))},maxLength:2,value:this.fromMinutes<10?"0".concat(this.fromMinutes):this.fromMinutes}))),s.a.createElement("tr",null,s.a.createElement("td",null,"To"),s.a.createElement("td",null,s.a.createElement(T,{min:"1",max:"12",type:"number",submit:function(t){e.props.setToDate(e.newDate("".concat(t,"/").concat(e.toDate,"/").concat(e.toYear),e.props.toDate))},maxLength:2,value:this.toMonth})),s.a.createElement("td",null,"/"),s.a.createElement("td",null,s.a.createElement(T,{min:"1",max:"31",type:"number",submit:function(t){e.props.setToDate(e.newDate("".concat(e.toMonth,"/").concat(t,"/").concat(e.toYear),e.props.toDate))},maxLength:2,value:this.toDate})),s.a.createElement("td",null,"/"),s.a.createElement("td",null,s.a.createElement(T,{min:"1900",max:"9999",type:"number",submit:function(t){e.props.setToDate(e.newDate("".concat(e.toMonth,"/").concat(e.toDate,"/").concat(t),e.props.toDate))},maxLength:4,value:this.toYear})),s.a.createElement("td",{className:"space"}),s.a.createElement("td",null,s.a.createElement(T,{min:"0",max:"23",type:"number",submit:function(t){e.props.setToTime(e.newTime(t,e.toMinutes,e.props.toTime))},maxLength:2,value:this.toHours<10?"0".concat(this.toHours):this.toHours})),s.a.createElement("td",null,":"),s.a.createElement("td",null,s.a.createElement(T,{min:"1",max:"60",type:"number",submit:function(t){e.props.setToTime(e.newTime(e.toHours,t,e.props.toTime))},maxLength:2,value:this.toMinutes<10?"0".concat(this.toMinutes):this.toMinutes}))),this.state.error?s.a.createElement("tr",null,s.a.createElement("td",{colSpan:"10"},s.a.createElement("div",{className:"errorMessage"},this.state.error))):null)))}},{key:"fromHours",get:function(){return Math.floor(this.props.fromTime/60)}},{key:"toHours",get:function(){return Math.floor(this.props.toTime/60)}},{key:"fromMinutes",get:function(){return this.props.fromTime%60}},{key:"toMinutes",get:function(){return this.props.toTime%60}},{key:"fromDate",get:function(){return this.props.fromDate.getDate()}},{key:"toDate",get:function(){return this.props.toDate.getDate()}},{key:"fromMonth",get:function(){return this.props.fromDate.getMonth()+1}},{key:"toMonth",get:function(){return this.props.toDate.getMonth()+1}},{key:"fromYear",get:function(){return this.props.fromDate.getFullYear()}},{key:"toYear",get:function(){return this.props.toDate.getFullYear()}}]),t}(n.Component),I=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={deleting:!1,deleted:!1,description:a.props.data.description,calories:a.props.data.calories,time:a.props.data.time,date:new Date(a.props.data.date),error:"",loading:!1},a.deleteEntry=a.deleteEntry.bind(Object(g.a)(a)),a}return Object(f.a)(t,e),Object(p.a)(t,[{key:"deleteEntry",value:function(){var e=this;this.props.setLoading(!0),this.setState({loading:!0}),y()({url:"meals",method:"DELETE",data:{_id:this.props._id,userId:this.props.selectedId}}).then(function(t){e.setState({deleted:!0}),e.props.updateList()}).catch(function(t){e.setState({error:t.response?t.response.data:t.message})}).finally(function(){return e.setState({loading:!1})})}},{key:"render",value:function(){var e=this;return!this.props.data||this.state.deleted?null:s.a.createElement(s.a.Fragment,null,s.a.createElement("tr",{className:this.props.over?"overAte":"underAte",onClick:function(){return e.props.setModalContents(s.a.createElement(U,{loading:e.state.loading,fromDate:e.props.fromDate,toDate:e.props.toDate,selectedId:e.props.selectedId,description:e.state.description,calories:e.state.calories,month:e.month,date:e.date,year:e.year,minutes:e.minutes,hours:e.hours,deleteEntry:e.deleteEntry,editing:!0,_id:e.props._id,updateMealsList:e.props.updateList,closeModal:function(){return e.props.setModalContents(null)}}))}},s.a.createElement("td",null,this.state.description),s.a.createElement("td",{className:"calorieTableDisplay"},this.state.calories),s.a.createElement("td",null,"".concat(this.month,"/").concat(this.date,"/").concat(this.year)),s.a.createElement("td",null,"".concat(this.hours<10?"0".concat(this.hours):this.hours,":").concat(this.minutes<10?"0".concat(this.minutes):this.minutes))),this.state.error?s.a.createElement("tr",null,s.a.createElement("td",{colSpan:"11"},s.a.createElement("div",{className:"errorMessage"},this.state.error))):null)}},{key:"hours",get:function(){return Math.floor(Number(this.state.time)/60)}},{key:"minutes",get:function(){return this.state.time%60}},{key:"date",get:function(){return this.state.date.getDate()}},{key:"month",get:function(){return this.state.date.getMonth()+1}},{key:"year",get:function(){return this.state.date.getFullYear()}}]),t}(n.Component),P=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).state={updateMealsList:!1},a}return Object(f.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement(s.a.Fragment,null,s.a.createElement("h1",{className:"header"},"".concat(this.props.name,"'s Calorie Tracker")),s.a.createElement("input",{type:"button",id:"logout",value:"Logout",onClick:this.props.logout}),s.a.createElement("div",{className:"sidebar"},s.a.createElement(N,{selectedId:this.props.selectedId,parCalories:this.props.parCalories,setPar:this.props.setPar}),s.a.createElement(U,{selectedId:this.props.selectedId,updateMealsList:function(){e.setState({updateMealsList:!e.state.updateMealsList})}})),s.a.createElement(L,{setModalContents:this.props.setModalContents,selectedId:this.props.selectedId,update:this.state.updateMealsList,parCalories:this.props.parCalories}))}}]),t}(n.Component);y.a.defaults.baseURL=function(){var e="s"===window.location.href[4]?"s":"",t=window.location.host,a="http".concat(e,"://").concat(window.location.host);return":3000"===t.slice(t.length-5)&&(a=a.slice(0,a.length-1)+"1"),a+"/api/"}(),y.a.defaults.headers.common.Authorization=window.localStorage.getItem("calorieJwt"),y.a.defaults.headers.post["Content-Type"]="application/json",y.a.interceptors.response.use(void 0,function(e){return"Login Required"===e.response.data&&(setTimeout(function(){var e=document.getElementById("logout");e&&e.click()},3e3),e.response.data="Login Required"),Promise.reject(e)});var F=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).state=a.defaultState,a.getUserData=a.getUserData.bind(Object(g.a)(a)),a.logout=a.logout.bind(Object(g.a)(a)),a.state={name:"",parCalories:0,modalContents:null,loading:!1},a.alreadyAttempted=0,a}return Object(f.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.getUserData()}},{key:"getUserData",value:function(e,t){var a=this;if(this.setState({loading:!0}),this.alreadyAttempted>=5)return this.setState({error:"We are experiencing technical difficulties. Please try again later."});y()({url:"users",method:"GET",params:{_id:e||void 0}}).then(function(){var e=Object(u.a)(l.a.mark(function e(n){var s,r;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:s=n.data,r=a.state.myId||s._id,a.setState(Object(c.a)({selectedId:s._id,myId:r,error:"",myRole:s._id===r?s.role:a.state.myRole},s)),t||y()({url:"jwt/freshToken",method:"GET"}).then(function(e){y.a.defaults.headers.common.Authorization=e.data,v(e.data)});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(t){t.response?(console.log(t.response.data),"Login Required"===t.response.data&&(y.a.defaults.headers.common.Authorization="",v(""),a.setState({error:""}))):t.response||(a.setState({error:"Loading..."}),a.alreadyAttempted+=1,setTimeout(function(){a.getUserData(e)},1e3))}).finally(function(){return a.setState({loading:!1})})}},{key:"logout",value:function(){v(""),y.a.defaults.headers.common.Authorization="",this.setState(this.defaultState)}},{key:"render",value:function(){var e,t=this;return e=Boolean(!this.state.name)?s.a.createElement(s.a.Fragment,null,s.a.createElement("h1",{className:"header"},"Welcome to Calorie Tracker!"),s.a.createElement(D,{getUserData:this.getUserData,loading:this.state.loading})):s.a.createElement(s.a.Fragment,null,this.state.modalContents?s.a.createElement(j,{children:this.state.modalContents}):null,/^admin|manager$/.test(this.state.myRole)?s.a.createElement(C,{setModalContents:function(e){return t.setState({modalContents:e})},myRole:this.state.myRole,myId:this.state.myId,selectedId:this.state.selectedId,getUserData:function(e){return t.getUserData(e)}}):null,s.a.createElement(P,{setModalContents:function(e){return t.setState({modalContents:e})},role:this.state.role,name:this.state.name,logout:this.logout,selectedId:this.state.selectedId,parCalories:this.state.parCalories,loading:this.state.loading,setPar:function(e){return t.setState({parCalories:e})}})),s.a.createElement(s.a.Fragment,null,this.state.error?this.state.error:e)}},{key:"defaultState",get:function(){return{name:"",parCalories:2e3,role:"regular",error:"",selectedId:"",myId:""}}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(s.a.createElement(F,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[23,1,2]]]);
//# sourceMappingURL=main.b9113a99.chunk.js.map